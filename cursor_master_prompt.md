# –ê–Ω–∞–ª–æ–≥ NextGIS Web - –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è –ì–ò–° –¥–ª—è —É—á–µ—Ç–∞ –í–û–õ–°
## Cursor Master Prompt –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ Python + Pyramid

---

## üìä –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø: NextGIS Web (–∞–Ω–∞–ª–æ–≥ TACL Pro)

–ò–∑ –≤—Å–µ—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π **NextGIS Web** - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–æ–≥–∞. –í–æ—Ç –ø–æ—á–µ–º—É:

### ‚úÖ –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ NextGIS Web:

1. **–ü–æ–ª–Ω–∞—è –æ—Ç–∫—Ä—ã—Ç–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** (350+ —Å—Ç—Ä–∞–Ω–∏—Ü)
   - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø–∏—Å–∞–Ω–∞
   - REST API –ø—Ä–∏–º–µ—Ä—ã
   - –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã —Å PostGIS
   
2. **–ó–Ω–∞–∫–æ–º—ã–π tech stack –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞**
   - Python (Pyramid framework) - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä
   - PostgreSQL + PostGIS - –∏–Ω–¥—É—Å—Ç—Ä–∏–∞–ª—å–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç
   - JavaScript/HTML/CSS - —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
   
3. **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –ª–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –í–û–õ–°
   - –†–µ—Å—É—Ä—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (—Å–ª–æ–∏, –∫–∞—Ä—Ç—ã, —Å–µ—Ä–≤–∏—Å—ã)
   - –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –≤—Å—Ç—Ä–æ–µ–Ω–∞
   - REST API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
   
4. **–°–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –í–û–õ–°**
   - PostGIS –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–µ–≤ –∏ –∫–∞—Ä—Ç
   - –†–∞–±–æ—Ç–∞ —Å –≥–µ–æ–¥–∞–Ω–Ω—ã–º–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
   - –≠–∫—Å–ø–æ—Ä—Ç –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–æ—Ä–º–∞—Ç–æ–≤

5. **–†–µ–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –†–æ—Å—Å–∏–∏**
   - NextGIS Mobile –¥–ª—è –ø–æ–ª–µ–≤–æ–≥–æ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å QGIS
   - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ç–µ–ª–µ–∫–æ–º–º-–ø—Ä–æ–µ–∫—Ç–∞—Ö

---

## üéØ MASTER PROMPT –î–õ–Ø CURSOR

```
–¢—ã - –æ–ø—ã—Ç–Ω—ã–π Python-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π—Å—è –Ω–∞ –ì–ò–°-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö 
–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Ç–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π.

–ó–∞–¥–∞—á–∞: –°–æ–∑–¥–∞—Ç—å –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –∞–Ω–∞–ª–æ–≥ NextGIS Web –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è 
–≤–æ–ª–æ–∫–æ–Ω–Ω–æ-–æ–ø—Ç–∏—á–µ—Å–∫–∏–º–∏ –ª–∏–Ω–∏—è–º–∏ —Å–≤—è–∑–∏ (–í–û–õ–°) –∏ —É–∑–ª–∞–º–∏ —Å–≤—è–∑–∏.

## –¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö –ê–†–•–ò–¢–ï–ö–¢–£–†–ï

### Backend (Python + Pyramid):
- –§—Ä–µ–π–º–≤–æ—Ä–∫: Pyramid 2.0+
- –°–£–ë–î: PostgreSQL 14+ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º PostGIS 3.2+
- ORM: SQLAlchemy 2.0+
- API: RESTful JSON API
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: JWT —Ç–æ–∫–µ–Ω—ã
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: Python logging + —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### Frontend (–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å):
- JavaScript (Vanilla –∏–ª–∏ Vue.js 3)
- WebGL –∫–∞—Ä—Ç–∞ (Leaflet –∏–ª–∏ OpenLayers)
- Bootstrap 5 –¥–ª—è UI
- Responsive design

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ (–¥–ª—è –í–û–õ–°):
1. **–£–∑–ª—ã —Å–≤—è–∑–∏** (Connection Nodes)
   - ID, –Ω–∞–∑–≤–∞–Ω–∏–µ, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (lat, lon)
   - —Ç–∏–ø —É–∑–ª–∞ (–º—É—Ñ—Ç–∞, –∫—Ä–æ—Å—Å, –ë–°–ü, —Ç–µ—Ä–º–∏–Ω–∞–ª)
   - —Å—Ç–∞—Ç—É—Å, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
   
2. **–í–æ–ª–æ–∫–Ω–∞** (Fibers)
   - ID, –Ω–∞–∑–≤–∞–Ω–∏–µ
   - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ª–æ–∫–æ–Ω –≤ –ø—É—á–∫–µ
   - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
   - –º–∞—Ä–∫–∞ –∫–∞–±–µ–ª—è
   
3. **–í–û–õ–° –º–∞—Ä—à—Ä—É—Ç—ã** (VOLS Routes)
   - ID, –Ω–∞–∑–≤–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∞
   - –Ω–∞—á–∞–ª—å–Ω—ã–π/–∫–æ–Ω–µ—á–Ω—ã–π —É–∑–µ–ª
   - –ª–∏–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∞ (LINESTRING PostGIS)
   - –¥–ª–∏–Ω–∞ –≤ –∫–º
   - —Å–ø–∏—Å–æ–∫ –≤–æ–ª–æ–∫–æ–Ω
   
4. **–°–≤—è–∑–∏** (Links)
   - –¥–≤–µ —Ç–æ—á–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –≤–æ–ª–æ–∫–Ω–∞—Ö
   - ID –≤–æ–ª–æ–∫–Ω–∞ –∏ —É–∑–ª—ã –Ω–∞ –∫–∞–∂–¥–æ–º –∫–æ–Ω—Ü–µ
   - —Å—Ç–∞—Ç—É—Å (–∞–∫—Ç–∏–≤–Ω–∞—è/—Ä–µ–∑–µ—Ä–≤–Ω–∞—è/–Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è)
   - –µ–º–∫–æ—Å—Ç—å, –ø–æ–ª–æ—Å–∞ –ø—Ä–æ–ø—É—Å–∫–∞–Ω–∏—è
   
5. **–ö–∞—Ä—Ç—ã/–ü—Ä–æ–µ–∫—Ç—ã** (WebMaps)
   - –Ω–∞–±–æ—Ä –≤–∏–¥–∏–º—ã—Ö —Å–ª–æ–µ–≤
   - –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
   - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ –ø—Ä–æ–µ–∫—Ç

### REST API Endpoints:

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É–∑–ª–∞–º–∏:
- GET /api/nodes - —Å–ø–∏—Å–æ–∫ —É–∑–ª–æ–≤
- POST /api/nodes - —Å–æ–∑–¥–∞–Ω–∏–µ —É–∑–ª–∞
- GET /api/nodes/{id} - –ø–æ–ª—É—á–∏—Ç—å —É–∑–µ–ª
- PUT /api/nodes/{id} - –æ–±–Ω–æ–≤–∏—Ç—å —É–∑–µ–ª
- DELETE /api/nodes/{id} - —É–¥–∞–ª–∏—Ç—å —É–∑–µ–ª
- GET /api/nodes/nearby?lat=X&lon=Y&distance=5 - –ø–æ–∏—Å–∫ –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –í–û–õ–°:
- GET /api/vols - —Å–ø–∏—Å–æ–∫ –í–û–õ–° –º–∞—Ä—à—Ä—É—Ç–æ–≤
- POST /api/vols - —Å–æ–∑–¥–∞–Ω–∏–µ –í–û–õ–° –º–∞—Ä—à—Ä—É—Ç–∞
- GET /api/vols/{id} - –ø–æ–ª—É—á–∏—Ç—å –í–û–õ–°
- PUT /api/vols/{id} - –æ–±–Ω–æ–≤–∏—Ç—å –í–û–õ–°
- DELETE /api/vols/{id} - —É–¥–∞–ª–∏—Ç—å –í–û–õ–°
- GET /api/vols/{id}/path - –ø–æ–ª—É—á–∏—Ç—å –≥–µ–æ–º–µ—Ç—Ä–∏—é –º–∞—Ä—à—Ä—É—Ç–∞ (GeoJSON)

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ–ª–æ–∫–Ω–∞–º–∏:
- GET /api/fibers - —Å–ø–∏—Å–æ–∫ –≤–æ–ª–æ–∫–æ–Ω
- POST /api/fibers - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–æ–ª–æ–∫–Ω–∞
- GET /api/fibers/by-vols/{vols_id} - –≤–æ–ª–æ–∫–Ω–∞ –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–µ
- PUT /api/fibers/{id} - –æ–±–Ω–æ–≤–∏—Ç—å –≤–æ–ª–æ–∫–Ω–æ

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑—è–º–∏:
- GET /api/links - —Å–ø–∏—Å–æ–∫ —Å–≤—è–∑–µ–π
- POST /api/links - —Å–æ–∑–¥–∞—Ç—å —Å–≤—è–∑—å
- GET /api/links/search?fiber_id=X&node_id=Y - –ø–æ–∏—Å–∫ —Å–≤—è–∑–µ–π
- PUT /api/links/{id}/status - –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å

#### –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö:
- GET /api/export/geojson?layer=nodes|vols|fibers - —ç–∫—Å–ø–æ—Ä—Ç –≤ GeoJSON
- GET /api/export/csv?layer=... - —ç–∫—Å–ø–æ—Ä—Ç –≤ CSV
- GET /api/export/shapefile?layer=... - —ç–∫—Å–ø–æ—Ä—Ç –≤ Shapefile (ZIP)

#### –ö–∞—Ä—Ç—ã –∏ –ø—Ä–∞–≤—ã –¥–æ—Å—Ç—É–ø–∞:
- GET /api/webmaps - —Å–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç
- POST /api/webmaps - —Å–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç—É
- GET /api/webmaps/{id}/config - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–∞—Ä—Ç—ã (—Å–ª–æ–∏, –ø—Ä–∞–≤–∞)
- PUT /api/webmaps/{id}/config - –æ–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:

```
vols-gis/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ vols_gis/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settings.py           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Pyramid
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py           # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ nodes.py          # –£–∑–ª—ã —Å–≤—è–∑–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fibers.py         # –í–æ–ª–æ–∫–Ω–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ vols.py           # –í–û–õ–° –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ links.py          # –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ webmaps.py        # –ö–∞—Ä—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ nodes.py          # Endpoints –¥–ª—è —É–∑–ª–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fibers.py         # Endpoints –¥–ª—è –≤–æ–ª–æ–∫–æ–Ω
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ vols.py           # Endpoints –¥–ª—è –í–û–õ–°
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ links.py          # Endpoints –¥–ª—è —Å–≤—è–∑–µ–π
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ webmaps.py        # Endpoints –¥–ª—è –∫–∞—Ä—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py           # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ geo.py            # –ì–µ–æ–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ export.py         # –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ permissions.py    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∞–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ nodes.py          # Validation schemas
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py           # JWT middleware
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cors.py           # CORS middleware
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ db.py                 # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app.py                # –ì–ª–∞–≤–Ω—ã–π Pyramid app
‚îÇ   ‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_nodes.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_vols.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îú‚îÄ‚îÄ setup.py
‚îÇ   ‚îî‚îÄ‚îÄ development.ini
‚îÇ
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bootstrap.min.css
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ style.css
‚îÇ   ‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ map.js               # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ–π Leaflet
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.js               # –ö–ª–∏–µ–Ω—Ç REST API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui.js                # –≠–ª–µ–º–µ–Ω—Ç—ã UI (–º–æ–¥–∞–ª–∫–∏, —Ñ–æ—Ä–º—ã)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app.js               # –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ assets/
‚îÇ       ‚îî‚îÄ‚îÄ icons/
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile.backend
‚îú‚îÄ‚îÄ init-db.sql                  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î —Å –í–û–õ–°-—Ç–∞–±–ª–∏—Ü–∞–º–∏
‚îî‚îÄ‚îÄ README.md
```

### –ú–æ–¥–µ–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (PostgreSQL/PostGIS):

```sql
-- –¢–∞–±–ª–∏—Ü–∞ —É–∑–ª–æ–≤ —Å–≤—è–∑–∏
CREATE TABLE nodes (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    node_type VARCHAR(50),  -- 'muft', 'cross', 'bsp', 'terminal'
    status VARCHAR(50),     -- 'active', 'inactive', 'maintenance'
    geom GEOMETRY(Point, 4326) NOT NULL,
    metadata JSONB,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);
CREATE INDEX idx_nodes_geom ON nodes USING GIST(geom);

-- –¢–∞–±–ª–∏—Ü–∞ –∫–∞–±–µ–ª–µ–π/–≤–æ–ª–æ–∫–æ–Ω
CREATE TABLE fibers (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    cable_type VARCHAR(100),    -- –º–∞—Ä–∫–∞ –∫–∞–±–µ–ª—è
    fiber_count INTEGER,        -- –∫–æ–ª-–≤–æ –≤–æ–ª–æ–∫–æ–Ω –≤ –ø—É—á–∫–µ
    status VARCHAR(50),         -- 'active', 'spare', 'damaged'
    vols_id INTEGER REFERENCES vols(id),
    metadata JSONB,
    created_at TIMESTAMP DEFAULT NOW()
);

-- –¢–∞–±–ª–∏—Ü–∞ –í–û–õ–° –º–∞—Ä—à—Ä—É—Ç–æ–≤
CREATE TABLE vols (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    start_node_id INTEGER REFERENCES nodes(id),
    end_node_id INTEGER REFERENCES nodes(id),
    path GEOMETRY(LineString, 4326) NOT NULL,
    length_km DECIMAL(10,2),
    status VARCHAR(50),         -- 'active', 'planning', 'under_construction'
    metadata JSONB,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);
CREATE INDEX idx_vols_path ON vols USING GIST(path);

-- –¢–∞–±–ª–∏—Ü–∞ —Å–≤—è–∑–µ–π (patch cords)
CREATE TABLE links (
    id SERIAL PRIMARY KEY,
    fiber_id INTEGER REFERENCES fibers(id),
    start_node_id INTEGER REFERENCES nodes(id),
    end_node_id INTEGER REFERENCES nodes(id),
    start_port INTEGER,         -- –Ω–æ–º–µ—Ä –ø–æ—Ä—Ç–∞ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ
    end_port INTEGER,           -- –Ω–æ–º–µ—Ä –ø–æ—Ä—Ç–∞ –Ω–∞ –∫–æ–Ω—Ü–µ
    status VARCHAR(50),         -- 'active', 'spare', 'unused'
    capacity_gbps DECIMAL(10,2),
    metadata JSONB,
    created_at TIMESTAMP DEFAULT NOW()
);

-- –¢–∞–±–ª–∏—Ü–∞ –≤–µ–±-–∫–∞—Ä—Ç
CREATE TABLE webmaps (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    description TEXT,
    visible_layers JSONB,       -- –∫–∞–∫–∏–µ —Å–ª–æ–∏ –≤–∏–¥–Ω—ã
    center_geom GEOMETRY(Point, 4326),
    zoom_level INTEGER DEFAULT 8,
    permissions JSONB,          -- –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(100) UNIQUE NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    role VARCHAR(50),           -- 'admin', 'operator', 'viewer'
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT NOW()
);
```

### –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

1. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ**:
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–∑–ª–æ–≤ –∫–∞–∫ –ø–∏–Ω–æ–≤
   - –ú–∞—Ä—à—Ä—É—Ç—ã –í–û–õ–° –∫–∞–∫ –ø–æ–ª–∏–ª–∏–Ω–∏–∏
   - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤
   - –í—Å–ø–ª—ã–≤–∞—é—â–∏–µ –æ–∫–Ω–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

2. **–ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è**:
   - –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —É–∑–ª–∞/–º–∞—Ä—à—Ä—É—Ç–∞
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É —É–∑–ª–∞, —Å—Ç–∞—Ç—É—Å—É
   - –ü–æ–∏—Å–∫ –ø–æ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –±–ª–∏–∑–æ—Å—Ç–∏
   - –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –∞—Ç—Ä–∏–±—É—Ç–æ–≤

3. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —É–∑–ª–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ
   - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–ø–µ—Ä–µ—Ç—è–≥–∏–≤–∞–Ω–∏–µ)
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ–ª–æ–∫–Ω–∞–º–∏ –∏ —Å–≤—è–∑—è–º–∏
   - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤

4. **–≠–∫—Å–ø–æ—Ä—Ç –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**:
   - –≠–∫—Å–ø–æ—Ä—Ç –≤ GeoJSON –¥–ª—è –æ–±–º–µ–Ω–∞ —Å –¥—Ä—É–≥–∏–º–∏ –ì–ò–°
   - –≠–∫—Å–ø–æ—Ä—Ç –≤ Shapefile –¥–ª—è QGIS
   - CSV –¥–ª—è —Ç–∞–±–ª–∏—Ü
   - WMS/WFS —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö —Å–∏—Å—Ç–µ–º

5. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º**:
   - –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (admin, operator, viewer)
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç—å—é —Å–ª–æ–µ–≤ –∏ –æ–±—ä–µ–∫—Ç–æ–≤
   - –ê—É–¥–∏—Ç –æ–ø–µ—Ä–∞—Ü–∏–π

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

- –í—Å–µ endpoints –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å JSON –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- –û—à–∏–±–∫–∏ –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å HTTP –∫–æ–¥—ã (400, 404, 500) —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º
- –í—Å–µ –≥–µ–æ–¥–∞–Ω–Ω—ã–µ –≤ EPSG:4326 (WGS84)
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ (limit, offset)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ query parameters
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è OpenAPI/Swagger
- Unit —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è –í–û–õ–°:

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä—è–º—ã–µ –ª–∏–Ω–∏–∏)
- –£—á–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–æ–ª–æ–∫–æ–Ω –≤ –æ–¥–Ω–æ–º –∫–∞–±–µ–ª–µ
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –≤–æ–ª–æ–∫–Ω–∞
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –º–∞—Ä—à—Ä—É—Ç–∞–º–∏
- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–ø—Ç–∏—á–µ—Å–∫–∏—Ö –ª–∏–Ω–∏–π

## –ù–ê–ß–ê–õ–û –†–ê–ó–†–ê–ë–û–¢–ö–ò:

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ Pyramid**
   ```
   pip install pyramid==2.0
   pcreate -s starter vols-gis
   ```

2. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**:
   ```
   pip install sqlalchemy geoalchemy2 psycopg2-binary 
   pip install pydantic marshmallow
   pip install pyramid_jwt pyramid_cors
   pip install pytest pytest-cov
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL —Å PostGIS**:
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å docker-compose –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–µ–º—É –ë–î —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –í–û–õ–°

4. **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É –ø–æ—Ä—è–¥–∫—É**:
   - –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (SQLAlchemy)
   - REST API –¥–ª—è —É–∑–ª–æ–≤
   - REST API –¥–ª—è –í–û–õ–° –º–∞—Ä—à—Ä—É—Ç–æ–≤
   - REST API –¥–ª—è –≤–æ–ª–æ–∫–æ–Ω –∏ —Å–≤—è–∑–µ–π
   - –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å Leaflet –∫–∞—Ä—Ç–æ–π
   - –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–∏—Å—Ç—É–ø–∏ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –ù–∞—á–Ω–∏ —Å –º–æ–¥–µ–ª–µ–π –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ Pyramid –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
–ó–∞–ø—Ä–æ—Å–∏ —É—Ç–æ—á–Ω–µ–Ω–∏—è –µ—Å–ª–∏ –Ω—É–∂–Ω—ã –¥–µ—Ç–∞–ª–∏ –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —á–∞—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.
```

---

## üìã –ü–û–ß–ï–ú–£ –ò–ú–ï–ù–ù–û –≠–¢–ê –ê–†–•–ò–¢–ï–ö–¢–£–†–ê:

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
1. **–ó–Ω–∞–∫–æ–º —Å Pyramid** - —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ NextGIS Web
2. **PostGIS** - –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è –≥–µ–æ–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. **–ú–æ–¥—É–ª—å–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –æ–±—ä–µ–∫—Ç–æ–≤
4. **REST API –ø–µ—Ä–≤—ã–º** - –ª–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
5. **–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥** - –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–¥—É–∫—Ç–µ (NextGIS Web)

### üöÄ –ú–∏–Ω–∏–º—É–º 3-4 –Ω–µ–¥–µ–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
- –ù–µ–¥–µ–ª—è 1: Backend (–º–æ–¥–µ–ª–∏ + –±–∞–∑–æ–≤—ã–µ API endpoints)
- –ù–µ–¥–µ–ª—è 2: –§—Ä–æ–Ω—Ç–µ–Ω–¥ (–∫–∞—Ä—Ç–∞ + –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- –ù–µ–¥–µ–ª—è 3: –≠–∫—Å–ø–æ—Ä—Ç + —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º
- –ù–µ–¥–µ–ª—è 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ + –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### üìä –°–ª–æ–∂–Ω–æ—Å—Ç—å: –°–†–ï–î–ù–Ø–Ø
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
- –í—Å—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —É–∂–µ –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–∞ –≤ NextGIS Web
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è –∏ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è
- –°—Ç–∞–±–∏–ª—å–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏

---

## üîó –ö–õ–Æ–ß–ï–í–´–ï –°–°–´–õ–ö–ò:

1. **NextGIS Web Documentation**: https://docs.nextgis.ru/docs_ngweb/source/intro.html
2. **Pyramid Documentation**: https://docs.pylonsproject.org/projects/pyramid/en/2.0/
3. **GeoAlchemy2**: https://geoalchemy-2.readthedocs.io/
4. **PostGIS Manual**: https://postgis.net/documentation/
5. **Leaflet.js**: https://leafletjs.com/
6. **OpenAPI/Swagger**: https://www.openapis.org/

---

## üéì –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ô –ü–û–†–Ø–î–û–ö –ò–ó–£–ß–ï–ù–ò–Ø:

1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –ì–ª–∞–≤—É 3 –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ NextGIS Web (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
2. –†–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (–ì–ª–∞–≤–∞ 14, —Ä–∞–±–æ—Ç–∞ —Å PostGIS)
3. –ò–∑—É—á–∏—Ç—å REST API NextGIS (–ì–ª–∞–≤–∞ 18 –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞)
4. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é –ì–ò–° —Å 2-3 —Ç–∏–ø–∞–º–∏ –æ–±—ä–µ–∫—Ç–æ–≤
5. –†–∞—Å—à–∏—Ä—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ

---

## ‚ö° QUICK START –ö–û–ú–ê–ù–î–´:

```bash
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
pcreate -s starter vols-gis
cd vols-gis

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -e .
pip install -e ".[testing]"

# –°–æ–∑–¥–∞–Ω–∏–µ –ë–î
createdb vols_gis_dev
psql vols_gis_dev -c "CREATE EXTENSION postgis;"
psql vols_gis_dev -f init-db.sql

# –ó–∞–ø—É—Å–∫ –≤ dev —Ä–µ–∂–∏–º–µ
pserve development.ini --reload

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
pytest

# API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:6543/api/
```

**–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –≥–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ Cursor IDE!**
